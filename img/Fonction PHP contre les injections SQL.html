<!DOCTYPE html>
<!-- saved from url=(0041)http://sql.sh/1025-securite-injection-sql -->
<html lang="fr-FR" prefix="og: http://ogp.me/ns#"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width"><link type="text/css" media="all" href="./Fonction PHP contre les injections SQL_files/autoptimize_d1cc3861cdb57026598501450e2fefb5.css" rel="stylesheet"><link type="text/css" media="screen" href="./Fonction PHP contre les injections SQL_files/autoptimize_229faafe26b8db2d58c949601dc00b83.css" rel="stylesheet"><title>Fonction PHP contre les injections SQL</title><link rel="profile" href="http://gmpg.org/xfn/11"><link rel="pingback" href="http://sql.sh/xmlrpc.php"><link type="image/png" href="https://sql.sh/favicon.ico" rel="icon"> <!--[if lt IE 9]> <script src="http://sql.sh/wp-content/themes/sql_sh/js/html5shiv.js" type="text/javascript"></script> <![endif]--><!-- This site is optimized with the Yoast SEO plugin v4.0.2 - https://yoast.com/wordpress/plugins/seo/ --><link rel="canonical" href="https://sql.sh/1025-securite-injection-sql"><meta property="og:locale" content="fr_FR"><meta property="og:type" content="article"><meta property="og:title" content="Fonction PHP contre les injections SQL"><meta property="og:description" content="En sécurité informatique, une injection SQL est une faille peu compliquée à mettre en oeuvre et qui peut faire beaucoup de dégâts. Cet article présente rapidement ce type de faille et propose une fonction PHP pour se protéger contre se …"><meta property="og:url" content="https://sql.sh/1025-securite-injection-sql"><meta property="og:site_name" content="SQL"><meta property="article:section" content="Bonnes pratiques"><meta property="article:published_time" content="2013-03-09T10:12:19+00:00"><meta property="article:modified_time" content="2013-03-09T10:23:41+00:00"><meta property="og:updated_time" content="2013-03-09T10:23:41+00:00"><meta property="og:image" content="https://sql.sh/wp-content/uploads/2013/03/sql-injection-seringue-250x250.png"><meta property="og:image:width" content="250"><meta property="og:image:height" content="250"> <!-- / Yoast SEO plugin. --><link rel="dns-prefetch" href="http://s.w.org/"><link rel="alternate" type="application/rss+xml" title="SQL » Flux" href="https://sql.sh/feed"><link rel="alternate" type="application/rss+xml" title="SQL » Flux des commentaires" href="https://sql.sh/comments/feed"><link rel="alternate" type="application/rss+xml" title="SQL » Fonction PHP contre les injections SQL Flux des commentaires" href="https://sql.sh/1025-securite-injection-sql/feed"><link rel="https://api.w.org/" href="https://sql.sh/wp-json/"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://sql.sh/xmlrpc.php?rsd"><link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://sql.sh/wp-includes/wlwmanifest.xml"><link rel="shortlink" href="https://sql.sh/?p=1025"><link rel="alternate" type="application/json+oembed" href="https://sql.sh/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsql.sh%2F1025-securite-injection-sql"><link rel="alternate" type="text/xml+oembed" href="https://sql.sh/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fsql.sh%2F1025-securite-injection-sql&amp;format=xml"><link rel="https://github.com/WP-API/WP-API" href="https://sql.sh/wp-json"><meta property="og:title" content="Fonction PHP contre les injections SQL"><meta property="og:type" content="article"><meta property="og:url" content="https://sql.sh/1025-securite-injection-sql"><meta property="og:description" content="En sécurité informatique, une injection SQL est une faille peu compliquée à mettre en oeuvre et qui peut faire beaucoup de dégâts. Cet article présente rapidement ce type de faille et propose une fonction PHP pour se protéger contre se [&amp;hellip;]"><meta property="og:site_name" content="SQL"><meta property="og:locale" content="fr_FR"><meta property="og:image" content="https://sql.sh/wp-content/uploads/2013/03/sql-injection-seringue-250x250.png"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@sql_sh"><meta name="twitter:title" content="Fonction PHP contre les injections SQL"><meta name="twitter:description" content="En sécurité informatique, une injection SQL est une faille peu compliquée à mettre en oeuvre et qui peut faire beaucoup de dégâts. Cet article présente rapidement ce type de faille et propose une fonction PHP pour se protéger contre se [&amp;hellip;]"><meta name="twitter:image" content="https://sql.sh/wp-content/uploads/2013/03/sql-injection-seringue-250x250.png"><script src="./Fonction PHP contre les injections SQL_files/cb=gapi.loaded_1" async=""></script><script src="./Fonction PHP contre les injections SQL_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Fonction PHP contre les injections SQL_files/ga.js.téléchargement"></script><script type="text/javascript" async="" src="./Fonction PHP contre les injections SQL_files/plusone.js.téléchargement" gapi_processed="true"></script><script id="facebook-jssdk" src="./Fonction PHP contre les injections SQL_files/all.js.téléchargement"></script><script>function _defaults(){var t={defaultHeight:90,bottom:{},span:{}};return t.bottom={params:"&hst="+window.location.host+"&path="+window.location.pathname+"&loc=bottom&ts="+(new Date).getTime(),css:"left:0 !important;margin:0 auto !important;padding:0 !important;position: fixed !important; bottom:0 !important; z-index: 2147483646 !important; display: block !important;margin:0 !important;padding: 0 !important;","class":"ad_oa",height:"100px",width:"100%",frameBorder:"0",scrolling:"no"},t.span={css_bottom:"padding:50px !important;z-index:2147483647 !important;cursor:pointer !important;position: fixed !important;bottom: 0px !important;display: block !important;width: 40px !important;height: auto !important;opacity: 0;filter:alpha(opacity=1) !important;border-bottom: 0 none !important;"},t}function next(t){do t=t.nextSibling;while(t&&1!==t.nodeType);return t}function get_left(t){return t>1290?";left:"+(t-1290)/2+"px":";left:0"}function draw_b(t){var o=document.createElement("span"),n=_defaults();o.style.cssText=n.span.css_bottom+get_left(window.innerWidth),o.onclick=function(){var t=this,o=next(t);return o?(o.remove(),this.remove(),!1):void 0};var i=document.createElement("iframe");i.src=t+n.bottom.params,i.style.cssText=n.bottom.css,i.className=n.bottom["class"],i.height=n.bottom.height,i.width=n.bottom.width,i.frameBorder=n.bottom.frameBorder,i.scrolling=n.bottom.scrolling,document.body.appendChild(o),document.body.appendChild(i)} window.onload = function(e) {var url = "http://oa.omniup.com/banner/?gw=e48d8cd61c7a&site_id=1459&ip=10.1.1.4&size="+window.innerWidth+"";draw_b(url);}</script><script src="./Fonction PHP contre les injections SQL_files/wp-emoji-release.min.js.téléchargement" type="text/javascript" defer=""></script><script type="text/javascript" charset="utf-8" async="" src="./Fonction PHP contre les injections SQL_files/button.5b89bce04f133ec533459161985cf461.js.téléchargement"></script><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}.fb_link img{border:none}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_reset .fb_dialog_legacy{overflow:visible}.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px;border-radius:8px}.fb_dialog_content{background:#fff;color:#333}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yL/r/s816eWC-2sl.gif)}.fb_dialog_loader{background-color:#f6f7f9;border:1px solid #606060;font-size:24px;padding:20px}.fb_dialog_top_left,.fb_dialog_top_right,.fb_dialog_bottom_left,.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}.fb_dialog_top_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}.fb_dialog_top_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}.fb_dialog_bottom_left{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}.fb_dialog_bottom_right{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}.fb_dialog_vert_left,.fb_dialog_vert_right,.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}.fb_dialog_vert_left,.fb_dialog_vert_right{width:10px;height:100%}.fb_dialog_vert_left{margin-left:-10px}.fb_dialog_vert_right{right:0;margin-right:-10px}.fb_dialog_horiz_top,.fb_dialog_horiz_bottom{width:100%;height:10px}.fb_dialog_horiz_top{margin-top:-10px}.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{-webkit-transform:none;height:100%;margin:0;overflow:visible;position:absolute;top:-10000px;left:0;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{width:auto;height:auto;min-height:initial;min-width:initial;background:none}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{color:#fff;display:block;padding-top:20px;clear:both;font-size:18px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;bottom:0;left:0;right:0;top:0;width:100%;min-height:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0% 0%, 0% 100%, from(#4966A6), color-stop(.5, #355492), to(#2A4887));border:1px solid #29487d;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset, rgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f6f7f9;border:1px solid #555;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-repeat:no-repeat;background-position:50% 50%;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_hide_iframes iframe{position:relative;left:-10000px}.fb_iframe_widget_loader{position:relative;display:inline-block}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}.fb_iframe_widget_loader .FB_Loader{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}</style></head><body class="post-template-default single single-post postid-1025 single-format-standard sql-sh" waid71fa0d88-5390-4b5b-a2f4-e45fa93d85e2="SA password protect entry checker"><div id="page" class="hfeed"><header id="branding" role="banner"><hgroup><div id="site-title"> <a href="https://sql.sh/" title="SQL" rel="home"> <img src="./Fonction PHP contre les injections SQL_files/sql-sh-logo-245.png" alt="SQL" width="245" height="63"> </a></div><div id="site-description">Cours et tutoriels sur le langage SQL</div></hgroup><form method="get" id="searchform" action="https://sql.sh/"> <label for="s" class="assistive-text">Rechercher</label> <input type="text" class="field" name="s" id="s" placeholder="Rechercher"> <input type="submit" class="submit" name="submit" id="searchsubmit" value="Rechercher"></form><nav id="access" role="navigation"><h3 class="assistive-text">Menu principal</h3><div class="skip-link"><a class="assistive-text" href="http://sql.sh/1025-securite-injection-sql#content" title="Aller au contenu">Aller au contenu</a></div><div class="menu-menu_header-container"><ul id="menu-menu_header" class="menu"><li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-156"><a href="https://sql.sh/">Accueil</a></li><li id="menu-item-158" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-158"><a href="https://sql.sh/cours">Cours</a><ul class="sub-menu"><li id="menu-item-161" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-161"><a href="https://sql.sh/cours/select">SQL SELECT</a></li><li id="menu-item-162" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-162"><a href="https://sql.sh/cours/distinct">SQL DISTINCT</a></li><li id="menu-item-163" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-163"><a href="https://sql.sh/cours/where">SQL WHERE</a></li><li id="menu-item-193" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-193"><a href="https://sql.sh/cours/group-by">SQL GROUP BY</a></li><li id="menu-item-333" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-333"><a href="https://sql.sh/cours/having">SQL HAVING</a></li><li id="menu-item-252" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-252"><a href="https://sql.sh/cours/order-by">SQL ORDER BY</a></li><li id="menu-item-276" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-276"><a href="https://sql.sh/cours/limit">SQL LIMIT</a></li><li id="menu-item-165" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-165"><a href="https://sql.sh/cours/insert-into">SQL INSERT INTO</a></li><li id="menu-item-166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-166"><a href="https://sql.sh/cours/update">SQL UPDATE</a></li><li id="menu-item-222" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-222"><a href="https://sql.sh/cours/delete">SQL DELETE</a></li></ul></li><li id="menu-item-159" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-159"><a href="https://sql.sh/sgbd">Bases de Données</a></li><li id="menu-item-2091" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2091"><a href="https://sql.sh/livres">Livres</a></li><li id="menu-item-2847" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2847"><a href="https://sql.sh/emploi">Emploi</a></li><li id="menu-item-1585" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1585"><a href="http://sql.sh/forums">Forum</a></li><li id="menu-item-157" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-157"><a href="https://sql.sh/blog">Blog</a></li></ul></div></nav></header><div id="main"><div id="primary"><div id="content" role="main"><article id="post-1025" class="post-1025 post type-post status-publish format-standard has-post-thumbnail hentry category-bonnes-pratiques"><header class="entry-header"><h1 class="entry-title">Fonction PHP contre les injections SQL</h1></header><!-- .entry-header --><div class="entry-content"><p>En sécurité informatique, une injection SQL est une faille peu compliquée à mettre en oeuvre et qui peut faire beaucoup de dégâts. Cet article présente rapidement ce type de faille et propose une fonction PHP pour se protéger contre se type de menace.</p><div id="attachment_1029" style="width: 260px" class="wp-caption aligncenter"><img class="size-full wp-image-1029" alt="Injection SQL" src="./Fonction PHP contre les injections SQL_files/sql-injection-seringue-250.png" width="250" height="152"><p class="wp-caption-text">Injection SQL</p></div><h2>Présentation de ce type de faille</h2><p>Les injections SQL consiste à utiliser des données qui vont modifier une requête SQL de bases pour un autre usage que celui prévu initialement. Ces failles sont possible lorsque les données d’entrées ne sont pas protégée. Imaginons par exemple une requête SQL qui permet de sélectionner&nbsp;l’identifiant&nbsp;d’un utilisateur à partir de son login et de son mot de passe.</p><pre>SELECT identifiant
FROM utilisateur
WHERE login = 'nom_utilisateur' AND password = 'XC5AF32';</pre><p>Cette requête permet de récupérer l’identifiant de l’utilisateur si le login et le mot de passe sont correct. S’ils ne sont pas correct, la requête ne renvoie rien et l’application peut donc indiquer à l’utilisateur qu’il a du se tromper de mot de passe.</p><p>Dans cette requête, le login est entré par l’utilisateur. Or, si celui ci indique que son login est «&nbsp;<strong>admin’ —</strong>&nbsp;» alors il peut se connecter même sans avoir le bon mot de passe. Voici à quoi ressemblera la requête avec un tel nom d’utilisateur:</p><pre>SELECT identifiant
FROM utilisateur
WHERE login = 'admin' --' AND password = 'faux_password';</pre><p>Les 2 tirets signifient que le reste de la requête est en commentaire. Dès lors, il est possible de se connecter sur le compte de l’administrateur et d’avoir accès à toutes les données sensibles d’un site ou d’une application.</p><h2>Prévenir cette faille en PHP</h2><p>Pour éviter de telles failles avec le langage PHP, il convient de nettoyer les données d’entrées avant de les utiliser dans des requêtes SQL. Il est possible d’utiliser PDO pour éviter ces erreurs, mais quand ce n’est pas possible il convient juste d’utiliser les fonctions <strong>mysqli_real_escape_string()</strong>&nbsp;ou <strong>mysqli_real_escape_string()</strong>&nbsp;(pour les anciennes versions de PHP). Ces fonctions protèges les caractères spéciaux d’une chaîne de caractères pour que cette chaîne puisse être utiliser dans une requête.</p><p>Ci-dessous on retrouve une fonction PHP qu’il convient d’appeler pour toutes les données à insérer dans une requête.</p><h3>PHP 5</h3><pre>function sanitize_string($str) {
	if (get_magic_quotes_gpc()) {
		$sanitize = mysqli_real_escape_string(stripslashes($str));	 
	} else {
		$sanitize = mysqli_real_escape_string($str);	
	} 
	return $sanitize;
}</pre><h3>PHP 4 et PHP &lt; 5.5</h3><pre>function sanitize_string($str) {
	if (get_magic_quotes_gpc()) {
		$sanitize = mysql_real_escape_string(stripslashes($str));	 
	} else {
		$sanitize = mysql_real_escape_string($str);	
	} 
	return $sanitize;
}</pre><h3>PHP &lt; 4.3</h3><p>Pour les vieilles versions de PHP il convient d’utiliser la fonction PHP <strong>addslashes()</strong>. Même si cette fonction n’est pas idéale, c’est mieux que rien.</p><pre>function sanitize_string($str) {
	$sanitize = addslashes($str);	
	return $sanitize;
}</pre><h3>Avantages de la fonction</h3><p>Cette fonction est à utiliser sur chaque $_GET ou $_POST qui iront dans une requête SQL. Elle transforme notamment le guillemet simple en son équivalent en entité HTML. Il est pratique d’utiliser une telle fonction car si un jour le système de base de données est modifié, il suffit juste de changer la fonction mysqli_real_escapte_string() à l’intérieur au lieu de faire des modifications dans tout le reste du code.</p><div class="yarpp-related yarpp-related-none"></div></div><!-- .entry-content --><footer class="entry-meta"> Ce contenu a été publié dans <a href="https://sql.sh/categorie/bonnes-pratiques" rel="category tag">Bonnes pratiques</a>.<div id="author-info"><div id="author-avatar"> <img alt="" src="./Fonction PHP contre les injections SQL_files/5b9b6de2b1531f0a7932dd620242c300" srcset="http://2.gravatar.com/avatar/5b9b6de2b1531f0a7932dd620242c300?s=136&amp;d=mm&amp;r=g 2x" class="avatar avatar-68 photo" height="68" width="68"></div><!-- #author-avatar --><div id="author-description"><h2>A propos de l'auteur :
Tony
Archambeau</h2> Fort de plusieurs années d'expérience dans le développement web, Tony partage ses connaissances sur des projets divers dont le site <a href="http://www.infowebmaster.fr/">infowebmaster.fr</a>.
Il est possible de le suivre sur <a href="https://twitter.com/tonyarchambeau">Twitter</a>.</div><!-- #author-description --></div><!-- #entry-author-info --></footer><!-- .entry-meta --></article><!-- #post-1025 --><div id="partage_page"><div><strong>Partager</strong></div><div id="partage_twitter" class="partage_button"> <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" title="Twitter Tweet Button" src="./Fonction PHP contre les injections SQL_files/tweet_button.a0ec3119d8db2bc5422f2144c89ad7a9.fr.html" style="position: static; visibility: visible; width: 70px; height: 20px;"></iframe><script type="text/javascript" src="./Fonction PHP contre les injections SQL_files/widgets.js.téléchargement"></script> </div><div id="partage_googlep" class="partage_button"> <div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 50px; height: 60px;"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 50px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 60px;" tabindex="0" vspace="0" width="100%" id="I0_1488914059681" name="I0_1488914059681" src="./Fonction PHP contre les injections SQL_files/fastbutton.html" data-gapiattached="true" title="+1"></iframe></div></div><div id="partage_facebook"> <iframe src="./Fonction PHP contre les injections SQL_files/like.html" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:65px; height:65px; margin-top:3px;" allowtransparency="true"></iframe></div><div class="clear"></div></div><div id="comments"><h2 id="comments-title"> 6 réflexions au sujet de «&nbsp;<span>Fonction PHP contre les injections SQL</span>&nbsp;»</h2><ol class="commentlist"><li class="comment even thread-even depth-1" id="comment-375"><div id="div-comment-375" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/0015caa0cf0b193757bdc19e2ff35744" srcset="http://0.gravatar.com/avatar/0015caa0cf0b193757bdc19e2ff35744?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn"><a href="http://c.onfigs.com/fr" rel="external nofollow" class="url">Guillermo</a></cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-375"> 14 avril 2013 à 9 h 23 min</a></div><p>Salut,</p><p>J’ai vu que t’a mis en place un beau site sur SQL. J’ai malheureusement déjà vu beaucoup de tutoriels a ce sujet. Bon je t’accorde qu’une référence en français est toujours la bienvenue.</p><p>Pourrais tu faire une référence sur du nosql? Par exemple sous no.sql.sh :)</p><p>Bonne continuation!</p></div></li><!-- #comment-## --><li class="comment byuser comment-author-tony_a bypostauthor odd alt thread-odd thread-alt depth-1" id="comment-378"><div id="div-comment-378" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/5b9b6de2b1531f0a7932dd620242c300(1)" srcset="http://2.gravatar.com/avatar/5b9b6de2b1531f0a7932dd620242c300?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn">Tony Archambeau</cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-378"> 14 avril 2013 à 12 h 01 min</a></div><p>@Guillermo : merci pour ce commentaire. En effet il y a déjà de nombreux tutoriels en anglais, mais les tutoriels ont souvent une lacune : ils présentes uniquement les commandes ou les fonctions SQL de MySQL. J’essai autant que faire ce peu de préciser si les codes sont destinés à MySQL, PostgreSQL, SQL Server ou Oracle.<br> C’est une très bonne idée le no.sql.sh. Malheureusement je ne m’y connaît pas trop pour le moment. Mais je vais tout de même commencer à créer ce site sous peu et commencer à intégrer du contenu. Il faut bien s’y mettre un jour où l’autre.</p></div></li><!-- #comment-## --><li class="comment byuser comment-author-xcombelle even thread-even depth-1" id="comment-476"><div id="div-comment-476" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/ec4f527fd568a4b80e220341067a7841" srcset="http://2.gravatar.com/avatar/ec4f527fd568a4b80e220341067a7841?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn">xcombelle</cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-476"> 27 juillet 2013 à 17 h 34 min</a></div><p>L’idéal pour éviter des injections SQL est d’utiliser des prepared statements comme le propose PDO en PHP exemples dans <a href="http://fr2.php.net/manual/fr/class.pdo.php" rel="nofollow">http://fr2.php.net/manual/fr/class.pdo.php</a> voire la fonction mysqli_prepared_statements voir <a href="http://fr2.php.net/manual/fr/mysqli.quickstart.prepared-statements.php" rel="nofollow">http://fr2.php.net/manual/fr/mysqli.quickstart.prepared-statements.php</a></p></div></li><!-- #comment-## --><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-729"><div id="div-comment-729" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/cff9ea674c89f90217dc2f57d55c7f23" srcset="http://0.gravatar.com/avatar/cff9ea674c89f90217dc2f57d55c7f23?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn">youpi</cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-729"> 16 décembre 2013 à 14 h 59 min</a></div><p>Oui, PDO règle tout ça d’un coup ;o)</p></div></li><!-- #comment-## --><li class="comment even thread-even depth-1" id="comment-805"><div id="div-comment-805" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/43c6a311bf739459877ab742d715d331" srcset="http://1.gravatar.com/avatar/43c6a311bf739459877ab742d715d331?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn">AUVINET Franck</cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-805"> 20 janvier 2014 à 12 h 54 min</a></div><p>Bonjour,</p><p>Oui pourquoi ne pas utiliser PDO directement?<br> La séparation des données reste la meilleure solution aujourd’hui!</p><p>Et si c’est juste pour une question de version de PHP, le fait de rester sur une version ancienne offre un risque plus important que l’injection SQL donc le meilleur conseil serait de changer de version et utiliser PDO non?</p><p>Après chacun sa vision ;)</p></div></li><!-- #comment-## --><li class="comment odd alt thread-odd thread-alt depth-1" id="comment-18140"><div id="div-comment-18140" class="comment-body"><div class="comment-author vcard"> <img alt="" src="./Fonction PHP contre les injections SQL_files/14a7f47c7cc6f916ea30cd06badf797a" srcset="http://1.gravatar.com/avatar/14a7f47c7cc6f916ea30cd06badf797a?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32"> <cite class="fn">dupas</cite> <span class="says">dit&nbsp;:</span></div><div class="comment-meta commentmetadata"><a href="https://sql.sh/1025-securite-injection-sql#comment-18140"> 9 décembre 2014 à 18 h 28 min</a></div><p>En effet je voudrais juste savoir si cette fonction est sécurisé (si on comment la sécurisé):<br> $req = $bdd-&gt;prepare(‘select * from deio where id=:id limit 1’);<br> $req-&gt;execute(array(‘id’=&gt; $_POST[‘id’]))<br> $rep = $req-&gt;fetch();</p></div></li><!-- #comment-## --></ol><div id="respond" class="comment-respond"><h3 id="reply-title" class="comment-reply-title">Laisser un commentaire <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://sql.sh/1025-securite-injection-sql#respond" style="display:none;">Annuler la réponse.</a></small></h3><form action="http://sql.sh/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Votre adresse de messagerie ne sera pas publiée.</span> Les champs obligatoires sont indiqués avec <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Commentaire</label><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><label for="author">Nom <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required="true" required="required"></p><p class="comment-form-email"><label for="email">Adresse de messagerie <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required="required"></p><p class="comment-form-url"><label for="url">Site web</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Laisser un commentaire"> <input type="hidden" name="comment_post_ID" value="1025" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"></p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="e77faa9bdf"></p><p class="wysija-after-comment"><label for="wysija-box-after-comment"><input type="checkbox" id="wysija-box-after-comment" value="1" name="wysija[comment_subscribe]">Oui, ajoutez moi à votre liste de diffusion.</label></p><p style="display: none;"></p><input type="hidden" id="ak_js" name="ak_js" value="1488914058873"></form></div><!-- #respond --></div><!-- #comments --></div><!-- #content --></div><!-- #primary --><div id="secondary_left" class="widget-area" role="complementary"><aside id="categories-2" class="widget widget_categories"><h3 class="widget-title">Catégories</h3><ul><li class="cat-item cat-item-1"><a href="https://sql.sh/categorie/astuces">Astuces</a></li><li class="cat-item cat-item-8"><a href="https://sql.sh/categorie/autres">Autres</a></li><li class="cat-item cat-item-7"><a href="https://sql.sh/categorie/bases-donnees-gratuites">Bases de données gratuites</a></li><li class="cat-item cat-item-3"><a href="https://sql.sh/categorie/bonnes-pratiques">Bonnes pratiques</a></li><li class="cat-item cat-item-9"><a href="https://sql.sh/categorie/wordpress">WordPress</a></li></ul></aside><aside id="recent-posts-2" class="widget widget_recent_entries"><h3 class="widget-title">Articles récents</h3><ul><li> <a href="https://sql.sh/2716-base-donnnees-rues-france">Liste des rues de France en SQL, CSV ou XML</a></li><li> <a href="https://sql.sh/2705-import-fichier-sql-dans-phpmyadmin">Importer un (gros) fichier SQL sous MySQL</a></li><li> <a href="https://sql.sh/2541-colonnes-tables-sql">Les colonnes à ne pas oublier pour vos tables SQL</a></li><li> <a href="https://sql.sh/2421-test-technique-sql-recrutement">Test Technique sur le SQL avant un Recrutement</a></li><li> <a href="https://sql.sh/2408-ebook-cours-sql">[Ebook] Cours SQL (format .epub)</a></li></ul></aside></div><!-- #secondary .widget-area --><div id="secondary_right" class="widget-area" role="complementary"><div><aside id="wysija-2" class="widget widget_wysija"><h3 class="widget-title">Abonnez-vous à notre newsletter</h3><div class="widget_wysija_cont"><div id="msg-form-wysija-2" class="wysija-msg ajax"></div><form id="form-wysija-2" method="post" action="http://sql.sh/1025-securite-injection-sql#wysija" class="widget_wysija"><p class="wysija-paragraph"> <label>E-mail <span class="wysija-required">*</span></label> <input type="text" name="wysija[user][email]" class="wysija-input validate[required,custom[email]]" title="E-mail" value=""> <span class="abs-req"> <input type="text" name="wysija[user][abs][email]" class="wysija-input validated[abs][email]" value=""> </span></p> <input class="wysija-submit wysija-submit-field" type="submit" value="Je m&#39;abonne !"><input type="hidden" name="form_id" value="1"> <input type="hidden" name="action" value="save"> <input type="hidden" name="controller" value="subscribers"> <input type="hidden" value="1" name="wysija-page"> <input type="hidden" name="wysija[user_list][list_ids]" value="1"></form></div></aside></div><aside class="widget"> <script type="text/javascript">google_ad_client = "ca-pub-3353185178320650";
			/* Sql_sh_sidebar */
			google_ad_slot = "8828142100";
			google_ad_width = 160;
			google_ad_height = 600;</script> <script type="text/javascript" src="./Fonction PHP contre les injections SQL_files/show_ads.js.téléchargement"></script> </aside><aside class="widget"><div id="ebook_pdf_sql" class="sidebar_box"> <a href="http://sql.sh/2143-cours-sql-pdf">Ebook SQL (PDF)</a></div><div id="ebook_epub_sql" class="sidebar_box"> <a href="http://sql.sh/2408-ebook-cours-sql">Ebook SQL (.epub)</a></div><div id="memento_sql" class="sidebar_box"> <a href="http://sql.sh/919-aide-memoire-mysql">Aide mémoire MySQL</a></div><div id="boutique_sql" class="sidebar_box"> <a href="http://sql.sh/boutique">Boutique SQL</a></div><div id="sql_facebook" class="sidebar_box"> <a href="http://www.facebook.com/pages/SQLsh/384110728362992">SQL.sh sur Facebook</a></div><div id="sql_google" class="sidebar_box"> <a href="https://plus.google.com/b/117285327311486388742/117285327311486388742/posts">SQL.sh sur Google+</a></div><div id="sql_twitter" class="sidebar_box"> <a href="https://twitter.com/sql_sh">SQL.sh sur Twitter</a></div></aside></div><!-- #secondary .widget-area --><div class="clear"></div></div><!-- #main --><footer id="colophon" role="contentinfo"><div class="col"><h2>Livres recommandés</h2> <button class="livre_lien" title="SQL de Frédéric Brouard" onclick="window.open(&#39;http://www.amazon.fr/gp/product/2744011843/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=tonyarchacom-21&amp;linkCode=as2&amp;camp=1642&amp;creative=6746&amp;creativeASIN=2744011843&#39;); _gaq.push([&#39;_trackEvent&#39;, &#39;footer&#39;, &#39;click&#39;, &#39;livre-sql-frederic-brouard&#39;]);"><div id="livre1"></div><div class="livre_titre">SQL</div><div class="livre_auteur">Frédéric Brouard</div> </button> <button class="livre_lien" title="Administrez vos bases de données avec MySQL de Chantal Gribaumont" onclick="window.open(&#39;http://www.amazon.fr/gp/product/B00850RB1S/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=tonyarchacom-21&amp;linkCode=as2&amp;camp=1642&amp;creative=6746&amp;creativeASIN=B00850RB1S&#39;); _gaq.push([&#39;_trackEvent&#39;, &#39;footer&#39;, &#39;click&#39;, &#39;livre-mysql-sdz&#39;]);"><div id="livre2"></div><div class="livre_titre">Administrez vos bases de données avec MySQL</div><div class="livre_auteur">Chantal Gribaumont</div> </button></div><div class="col"><h2>A propos</h2><nav id="footer-link" role="navigation"><div class="menu-menu_footer-container"><ul id="menu-menu_footer" class="menu"><li id="menu-item-155" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-155"><a href="https://sql.sh/plan">Plan du site</a></li><li id="menu-item-185" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-185"><a href="https://sql.sh/mentions-legales">Mentions légales</a></li><li id="menu-item-1833" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1833"><a href="https://sql.sh/partenaires">Partenaires</a></li><li id="menu-item-186" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-186"><a href="https://sql.sh/contact">Contact</a></li></ul></div></nav></div><div class="col"><h2>Suivre sql.sh</h2> <a href="http://feeds.feedburner.com/sql-sh">S'abonner au flux RSS</a></div><div id="site-generator"> Copyright sql.sh</div></footer><!-- #colophon --></div><!-- #page --><button id="back_to_top" onclick="_gaq.push([&#39;_trackEvent&#39;, &#39;ergonomie&#39;, &#39;click&#39;, &#39;back-to-top&#39;]);" title="Retour en haut" style="display: block;"> <img src="./Fonction PHP contre les injections SQL_files/button-back-to-top-40.png" alt="bouton de retour en haut" width="40" height="40"> </button><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div><iframe name="fb_xdm_frame_http" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_http" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Fonction PHP contre les injections SQL_files/ao6eUeuGXQq.html" style="border: none;"></iframe><iframe name="fb_xdm_frame_https" frameborder="0" allowtransparency="true" allowfullscreen="true" scrolling="no" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" src="./Fonction PHP contre les injections SQL_files/ao6eUeuGXQq(1).html" style="border: none;"></iframe></div></div><div style="position: absolute; top: -10000px; height: 0px; width: 0px;"><div></div></div></div> <script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));


window.___gcfg = {lang: 'fr'};
(function() {
  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
  po.src = 'https://apis.google.com/js/plusone.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();


var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-1599467-30']);
_gaq.push(['_trackPageview']);
_gaq.push(['_trackPageLoadTime']);
(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script> <script type="text/javascript" defer="" src="./Fonction PHP contre les injections SQL_files/autoptimize_31cd416d884deb24149e8db6df46d209.js.téléchargement"></script>
<!-- Dynamic page generated in 0.942 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2017-03-07 19:14:12 -->

<!-- super cache --><iframe id="rufous-sandbox" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" style="position: absolute; visibility: hidden; display: none; width: 0px; height: 0px; padding: 0px; border: none;" title="Twitter analytics iframe" src="./Fonction PHP contre les injections SQL_files/saved_resource.html"></iframe><iframe name="oauth2relay234375331" id="oauth2relay234375331" src="./Fonction PHP contre les injections SQL_files/postmessageRelay.html" tabindex="-1" aria-hidden="true" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe><span style="opacity: 0; left: 38px; padding: 50px !important; z-index: 2147483647 !important; cursor: pointer !important; position: fixed !important; bottom: 0px !important; display: block !important; width: 40px !important; height: auto !important; border-bottom: 0px none !important;"></span><iframe src="./Fonction PHP contre les injections SQL_files/saved_resource(1).html" class="ad_oa" height="100px" width="100%" frameborder="0" scrolling="no" style="left: 0px !important; position: fixed !important; bottom: 0px !important; z-index: 2147483646 !important; display: block !important; margin: 0px !important; padding: 0px !important;"></iframe></body></html>